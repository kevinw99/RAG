WARNING:root:Prometheus client not available - metrics will be stored in memory only
{"timestamp": "2025-07-31T15:44:43.994205", "level": "INFO", "logger": "rag_system.monitoring.logging_config", "message": "Logging configured: level=DEBUG, format=json, console=True, file=True", "file": "logging_config.py", "line": 158, "function": "configure_logging", "taskName": null}
ðŸš€ Starting RAG API Server...
==================================================
Server will be available at: http://localhost:8000
API Documentation: http://localhost:8000/docs
Health Check: http://localhost:8000/health
==================================================
INFO:     Will watch for changes in these directories: ['/Users/kweng/AI/RAG']
INFO:     Started server process [38127]
INFO:     Waiting for application startup.
{"timestamp": "2025-07-31T15:44:44.053945", "level": "INFO", "logger": "rag_system.api", "message": "Starting RAG API server...", "file": "server.py", "line": 136, "function": "lifespan", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:44.054168", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "RAGPipeline created: collection=rag_documents", "file": "pipeline.py", "line": 71, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:44.054215", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Initializing RAG pipeline components...", "file": "pipeline.py", "line": 84, "function": "initialize", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:44.054269", "level": "INFO", "logger": "rag_system.core.document_processor", "message": "DocumentProcessor initialized: chunk_size=1000, chunk_overlap=100, batch_size=1000", "file": "document_processor.py", "line": 63, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:44.207393", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:46.787072", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:46.792505", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:46.800725", "level": "INFO", "logger": "rag_system.core.generator", "message": "ResponseGenerator initialized: anthropic/claude-3-haiku-20240307", "file": "generator.py", "line": 373, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:46.924839", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Found 44287 existing chunks, initializing retriever...", "file": "pipeline.py", "line": 119, "function": "initialize", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:46.925004", "level": "WARNING", "logger": "rag_system.core.retriever", "message": "No chunks provided for BM25. Will use vector search only.", "file": "retriever.py", "line": 247, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:46.925056", "level": "INFO", "logger": "rag_system.core.retriever", "message": "Loading cross-encoder model: cross-encoder/ms-marco-MiniLM-L-6-v2", "file": "retriever.py", "line": 153, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:48.225362", "level": "INFO", "logger": "rag_system.core.retriever", "message": "Cross-encoder model loaded successfully", "file": "retriever.py", "line": 156, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:48.225689", "level": "INFO", "logger": "rag_system.core.retriever", "message": "HybridRetriever initialized: alpha=0.5, reranking=True", "file": "retriever.py", "line": 265, "function": "__init__", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:48.225782", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Retriever initialized with existing chunks", "file": "pipeline.py", "line": 127, "function": "initialize", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:48.225885", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline initialized successfully in 4.17s", "file": "pipeline.py", "line": 138, "function": "initialize", "taskName": "Task-2"}
{"timestamp": "2025-07-31T15:44:48.225962", "level": "INFO", "logger": "rag_system.api", "message": "RAG pipeline initialized successfully", "file": "server.py", "line": 141, "function": "lifespan", "taskName": "Task-2"}
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
{"timestamp": "2025-07-31T15:44:58.094947", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-3", "request_id": "7ab1efc2"}
{"timestamp": "2025-07-31T15:44:59.102389", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:00.853817", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:00.856697", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T15:45:03.152029", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 5.057s - Status: degraded", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:03.232678", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 5.138s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-3", "request_id": "7ab1efc2"}
{"timestamp": "2025-07-31T15:45:11.669352", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-6", "request_id": "5c4fd571"}
{"timestamp": "2025-07-31T15:45:12.690901", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:14.535342", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:14.541125", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:16.390169", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.720s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:16.452652", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 4.783s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-6", "request_id": "5c4fd571"}
INFO:     127.0.0.1:53993 - "GET /health HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T15:45:16.455446", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-9", "request_id": "e707e016"}
{"timestamp": "2025-07-31T15:45:16.457184", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline already initialized", "file": "pipeline.py", "line": 80, "function": "initialize", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
{"timestamp": "2025-07-31T15:45:16.562797", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-50c711f5-115d-4788-9eb0-1e4bb68d1cb5', 'json_data': {'max_tokens': 1000, 'messages': [{'role': 'user', 'content': 'Context:\\n[1] Source: optimization.pdf\\nDocument: optimization.pdf - Introduction to Modern Portfolio Theory Adding Constraints Summary Portfolio Optimization Theoretica...\\n\\nContent: Introduction to Modern Portfolio Theory Adding Constraints Summary Portfolio Optimization Theoretically, how does it work? J.G. Watson Financial Engines Retiree Research Center October 8, 2012 J.G. Watson Portfolio Optimization Introduction to Modern Portfolio Theory Adding Constraints Summary Outline 1Introduction to Modern Portfolio Theory 2Adding Constraints 3Summary J.G. Watson Portfolio Optimization Introduction to Modern Portfolio Theory Adding Constraints Summary Harry M. Markowitz Harry Markowitz described Modern Portfolio Theory in a paper appearing in the March 1952 issue of The Journal of Finance . Investors are concerned with their portfolio\u2019s expected return and risk, which is measured by a portfolio\u2019s variance of returns. They prefer higher expected returns and lower risk, but are willing to make trade offs. J.G.\\n\\n[2] Source: optimization.pdf\\nDocument: optimization.pdf - Introduction to Modern Portfolio Theory Adding Constraints Summary Portfolio Optimization Theoretica...\\n\\nContent: ptimization and better estimates of expected returns. Style Analysis and the covariance matrix. J.G. Watson Portfolio Optimization Appendix For Further Reading For Further Reading I Philip E. Gill, Walter Murray, and Margaret H. Wright Practical Optimization Academic Press, 1981 Section 5.2.1., A Model Algorithm, 168\u2013169 Section 5.3.2.1., Positive-definite quadratic programming, 177\u2013178. Harry M. Markowitz, Portfolio Selection, 2nd Edition Blackwell, Cambridge, MA, 1991. Harry M. Markowitz Portfolio Selection The Journal of Finance , 7 (1): 77\u201391, March 1952 J.G. Watson Portfolio Optimization Appendix For Further Reading For Further Reading II William F . Sharpe An Algorithm for Portfolio Improvement Advances in Mathematical Programming and Financial Planning K.D. Lawrence, J.B. Guerard, Jr., and G.D. Reeves, Editors, JAI Press, Inc., 155\u2013170, 1987. J.G. Watson Portfolio Optimization\\n\\n[3] Source: OptimizationEnhancementsSpec.doc\\nDocument: OptimizationEnhancementsSpec.doc - Engine Design Specification: Optimization Enhancements Version: 1.3 Notes: History. Table of Content...\\n\\nContent: d Quality Assurance. 36 6.0 Future Directions. 36 7.0 References. 36 8.0 Open Items. 36 1.0 Summary. This document describes additional features used in constructing portfolio recommendations that are not described in the base specification document Optimization. That document describes the construction of portfolio expected return and covariance matrices for use in mean-variance optimization. The documents Load Aware Optimization and Taxable Advice describe adjustments to fund-level or account-level data that are fed into the optimization problem. This document details several enhancements to the basic optimization framework that were created to make portfolio recommendations more palatable, easier to justify, or more sound from a fiduciary perspective. The specific features described here are: Advice Palatability Company Stock Advisability and the Diversity Budget Whole Percent Optimization Multiple Share Classes Money Market Funds S&P 500 Index Funds 3% Rule Pre-Mixed, Life-Cycle, a\\n\\nQuestion: What is portfolio optimization?\\n\\nPlease provide a comprehensive answer based on the context above. Include source references where appropriate.'}], 'model': 'claude-3-haiku-20240307', 'system': \"You are a knowledgeable assistant that answers questions based on provided context. \\nFollow these guidelines:\\n\\n1. Use ONLY the provided context to answer the question\\n2. If the context doesn't contain enough information, say so clearly\\n3. Include specific references to sources when possible\\n4. Be concise but comprehensive\\n5. If uncertain, indicate your level of confidence\\n\\nContext will be provided as numbered chunks with source information.\", 'temperature': 0.1}}", "file": "_base_client.py", "line": 493, "function": "_build_request", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.563691", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Sending HTTP Request: POST https://api.anthropic.com/v1/messages", "file": "_base_client.py", "line": 1626, "function": "request", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.564094", "level": "DEBUG", "logger": "httpcore.connection", "message": "connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=None", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.568265", "level": "DEBUG", "logger": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16ab485c0>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.568350", "level": "DEBUG", "logger": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x16ae63e50> server_hostname='api.anthropic.com' timeout=None", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.611629", "level": "DEBUG", "logger": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16ab48800>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.612005", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.612351", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.612425", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.612558", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:16.612609", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.190157", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 31 Jul 2025 22:45:19 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'50000'), (b'anthropic-ratelimit-input-tokens-remaining', b'49000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-07-31T22:45:17Z'), (b'anthropic-ratelimit-output-tokens-limit', b'10000'), (b'anthropic-ratelimit-output-tokens-remaining', b'10000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-07-31T22:45:20Z'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2025-07-31T22:45:17Z'), (b'anthropic-ratelimit-tokens-limit', b'60000'), (b'anthropic-ratelimit-tokens-remaining', b'59000'), (b'anthropic-ratelimit-tokens-reset', b'2025-07-31T22:45:17Z'), (b'request-id', b'req_011CRfubZsNJhYEm6KHrSmcT'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'c20be06b-ec2d-4d26-a60a-c6308d63ce1c'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9680a00b4a59ed3d-SJC'), (b'Content-Encoding', b'gzip')])", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.196245", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.197399", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.197777", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.198111", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.198663", "level": "DEBUG", "logger": "anthropic._base_client", "message": "HTTP Response: POST https://api.anthropic.com/v1/messages \"200 OK\" Headers({'date': 'Thu, 31 Jul 2025 22:45:19 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '50000', 'anthropic-ratelimit-input-tokens-remaining': '49000', 'anthropic-ratelimit-input-tokens-reset': '2025-07-31T22:45:17Z', 'anthropic-ratelimit-output-tokens-limit': '10000', 'anthropic-ratelimit-output-tokens-remaining': '10000', 'anthropic-ratelimit-output-tokens-reset': '2025-07-31T22:45:20Z', 'anthropic-ratelimit-requests-limit': '50', 'anthropic-ratelimit-requests-remaining': '49', 'anthropic-ratelimit-requests-reset': '2025-07-31T22:45:17Z', 'anthropic-ratelimit-tokens-limit': '60000', 'anthropic-ratelimit-tokens-remaining': '59000', 'anthropic-ratelimit-tokens-reset': '2025-07-31T22:45:17Z', 'request-id': 'req_011CRfubZsNJhYEm6KHrSmcT', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': 'c20be06b-ec2d-4d26-a60a-c6308d63ce1c', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '9680a00b4a59ed3d-SJC', 'content-encoding': 'gzip'})", "file": "_base_client.py", "line": 1664, "function": "request", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.199147", "level": "DEBUG", "logger": "anthropic._base_client", "message": "request_id: req_011CRfubZsNJhYEm6KHrSmcT", "file": "_base_client.py", "line": 1672, "function": "request", "taskName": "Task-14"}
{"timestamp": "2025-07-31T15:45:19.224348", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Completed in 2.769s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-9", "request_id": "e707e016"}
INFO:     127.0.0.1:54006 - "POST /query HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T15:45:44.901677", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-18", "request_id": "ed4ff8ea"}
{"timestamp": "2025-07-31T15:45:44.902482", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline already initialized", "file": "pipeline.py", "line": 80, "function": "initialize", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T15:45:44.956736", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-fdcabba4-07ab-4736-978d-e8b6a1bb8a59', 'json_data': {'max_tokens': 1000, 'messages': [{'role': 'user', 'content': \"Context:\\n[1] Source: optimization.pdf\\nDocument: optimization.pdf - Introduction to Modern Portfolio Theory Adding Constraints Summary Portfolio Optimization Theoretica...\\n\\nContent: Introduction to Modern Portfolio Theory Adding Constraints Summary Portfolio Optimization Theoretically, how does it work? J.G. Watson Financial Engines Retiree Research Center October 8, 2012 J.G. Watson Portfolio Optimization Introduction to Modern Portfolio Theory Adding Constraints Summary Outline 1Introduction to Modern Portfolio Theory 2Adding Constraints 3Summary J.G. Watson Portfolio Optimization Introduction to Modern Portfolio Theory Adding Constraints Summary Harry M. Markowitz Harry Markowitz described Modern Portfolio Theory in a paper appearing in the March 1952 issue of The Journal of Finance . Investors are concerned with their portfolio\u2019s expected return and risk, which is measured by a portfolio\u2019s variance of returns. They prefer higher expected returns and lower risk, but are willing to make trade offs. J.G.\\n\\n[2] Source: Invest_Methodology_WhitePaper_120710.pdf\\nDocument: Invest_Methodology_WhitePaper_120710.pdf - Investment Methodology A Due Diligence Guide Financial Engines Investment Methodologyii Table of Con...\\n\\nContent: company stock. Contributions to company stock resume once the long-term target for stock is reached. This additional stock flexibility offers help to those participants who have concentrated holdings in company stock but also a strong aversion to immediately selling their stock holdings. Individuals' fears about selling at what could turn out to be the \u201cwrong\u201d time (should the stock price outperform the market after selling) can be overcome by a commitment to diversifying gradually and in the future. This enhanced flexibility follows Financial Engines' philosophy to limit concentrated risk with a focus on long-term retirement outcomes. Ongoing Portfolio Management As many factors change over time, ongoing portfolio management is important in helping program members achieve their specific retirement goals. Financial Engines regularly updates the target allocation for each member of its Professional Management program.\\n\\n[3] Source: FE_Invest_Methodology_WhitePaper_101510c_Final.pdf\\nDocument: FE_Invest_Methodology_WhitePaper_101510c_Final.pdf - Investment Methodology A Due Diligence Guide Financial Engines Investment Methodologyii Table of Con...\\n\\nContent: company stock. Contributions to company stock resume once the long-term target for stock is reached. This additional stock flexibility offers help to those participants who have concentrated holdings in company stock but also a strong aversion to immediately selling their stock holdings. Individuals' fears about selling at what could turn out to be the \u201cwrong\u201d time (should the stock price outperform the market after selling) can be overcome by a commitment to diversifying gradually and in the future. This enhanced flexibility follows Financial Engines' philosophy to limit concentrated risk with a focus on long-term retirement outcomes. Ongoing Portfolio Management As many factors change over time, ongoing portfolio management is important in helping program members achieve their specific retirement goals. Financial Engines regularly updates the target allocation for each member of its Professional Management program.\\n\\nQuestion: What is Modern Portfolio Theory?\\n\\nPlease provide a comprehensive answer based on the context above. Include source references where appropriate.\"}], 'model': 'claude-3-haiku-20240307', 'system': \"You are a knowledgeable assistant that answers questions based on provided context. \\nFollow these guidelines:\\n\\n1. Use ONLY the provided context to answer the question\\n2. If the context doesn't contain enough information, say so clearly\\n3. Include specific references to sources when possible\\n4. Be concise but comprehensive\\n5. If uncertain, indicate your level of confidence\\n\\nContext will be provided as numbered chunks with source information.\", 'temperature': 0.1}}", "file": "_base_client.py", "line": 493, "function": "_build_request", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:44.957212", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Sending HTTP Request: POST https://api.anthropic.com/v1/messages", "file": "_base_client.py", "line": 1626, "function": "request", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:44.957433", "level": "DEBUG", "logger": "httpcore.connection", "message": "close.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:44.957714", "level": "DEBUG", "logger": "httpcore.connection", "message": "close.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:44.957803", "level": "DEBUG", "logger": "httpcore.connection", "message": "connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=None socket_options=None", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:44.960925", "level": "DEBUG", "logger": "httpcore.connection", "message": "connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16ab6ed20>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:44.961019", "level": "DEBUG", "logger": "httpcore.connection", "message": "start_tls.started ssl_context=<ssl.SSLContext object at 0x16ae63e50> server_hostname='api.anthropic.com' timeout=None", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:45.006635", "level": "DEBUG", "logger": "httpcore.connection", "message": "start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16e78caa0>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:45.006874", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:45.007045", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:45.007094", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:45.007202", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:45.007245", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.131946", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 31 Jul 2025 22:45:47 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'50000'), (b'anthropic-ratelimit-input-tokens-remaining', b'49000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-07-31T22:45:46Z'), (b'anthropic-ratelimit-output-tokens-limit', b'10000'), (b'anthropic-ratelimit-output-tokens-remaining', b'10000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-07-31T22:45:48Z'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2025-07-31T22:45:46Z'), (b'anthropic-ratelimit-tokens-limit', b'60000'), (b'anthropic-ratelimit-tokens-remaining', b'59000'), (b'anthropic-ratelimit-tokens-reset', b'2025-07-31T22:45:46Z'), (b'request-id', b'req_011CRfudfGN8KFN1wFKR2ifV'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'c20be06b-ec2d-4d26-a60a-c6308d63ce1c'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9680a0bcb99c15a8-SJC'), (b'Content-Encoding', b'gzip')])", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.133450", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.133929", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.134124", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.134333", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.134654", "level": "DEBUG", "logger": "anthropic._base_client", "message": "HTTP Response: POST https://api.anthropic.com/v1/messages \"200 OK\" Headers({'date': 'Thu, 31 Jul 2025 22:45:47 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '50000', 'anthropic-ratelimit-input-tokens-remaining': '49000', 'anthropic-ratelimit-input-tokens-reset': '2025-07-31T22:45:46Z', 'anthropic-ratelimit-output-tokens-limit': '10000', 'anthropic-ratelimit-output-tokens-remaining': '10000', 'anthropic-ratelimit-output-tokens-reset': '2025-07-31T22:45:48Z', 'anthropic-ratelimit-requests-limit': '50', 'anthropic-ratelimit-requests-remaining': '49', 'anthropic-ratelimit-requests-reset': '2025-07-31T22:45:46Z', 'anthropic-ratelimit-tokens-limit': '60000', 'anthropic-ratelimit-tokens-remaining': '59000', 'anthropic-ratelimit-tokens-reset': '2025-07-31T22:45:46Z', 'request-id': 'req_011CRfudfGN8KFN1wFKR2ifV', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': 'c20be06b-ec2d-4d26-a60a-c6308d63ce1c', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '9680a0bcb99c15a8-SJC', 'content-encoding': 'gzip'})", "file": "_base_client.py", "line": 1664, "function": "request", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.135063", "level": "DEBUG", "logger": "anthropic._base_client", "message": "request_id: req_011CRfudfGN8KFN1wFKR2ifV", "file": "_base_client.py", "line": 1672, "function": "request", "taskName": "Task-23"}
{"timestamp": "2025-07-31T15:45:47.137300", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Completed in 2.236s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-18", "request_id": "ed4ff8ea"}
INFO:     127.0.0.1:54124 - "POST /query HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T15:45:47.144786", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-27", "request_id": "3f385e6b"}
{"timestamp": "2025-07-31T15:45:47.146034", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline already initialized", "file": "pipeline.py", "line": 80, "function": "initialize", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T15:45:47.211674", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-e44ccae7-68b3-4cfd-8b5a-7f9af8ce2aea', 'json_data': {'max_tokens': 1000, 'messages': [{'role': 'user', 'content': 'Context:\\n[1] Source: OptimizationEnhancementsSpec.doc\\nDocument: OptimizationEnhancementsSpec.doc - Engine Design Specification: Optimization Enhancements Version: 1.3 Notes: History. Table of Content...\\n\\nContent: d Quality Assurance. 36 6.0 Future Directions. 36 7.0 References. 36 8.0 Open Items. 36 1.0 Summary. This document describes additional features used in constructing portfolio recommendations that are not described in the base specification document Optimization. That document describes the construction of portfolio expected return and covariance matrices for use in mean-variance optimization. The documents Load Aware Optimization and Taxable Advice describe adjustments to fund-level or account-level data that are fed into the optimization problem. This document details several enhancements to the basic optimization framework that were created to make portfolio recommendations more palatable, easier to justify, or more sound from a fiduciary perspective. The specific features described here are: Advice Palatability Company Stock Advisability and the Diversity Budget Whole Percent Optimization Multiple Share Classes Money Market Funds S&P 500 Index Funds 3% Rule Pre-Mixed, Life-Cycle, a\\n\\n[2] Source: OptimizationEnhancementsSpec.doc\\nDocument: OptimizationEnhancementsSpec.doc - Engine Design Specification: Optimization Enhancements Version: 1.3 Notes: History. Table of Content...\\n\\nContent: d Quality Assurance. 36 6.0 Future Directions. 36 7.0 References. 36 8.0 Open Items. 36 1.0 Summary. This document describes additional features used in constructing portfolio recommendations that are not described in the base specification document Optimization. That document describes the construction of portfolio expected return and covariance matrices for use in mean-variance optimization. The documents Load Aware Optimization and Taxable Advice describe adjustments to fund-level or account-level data that are fed into the optimization problem. This document details several enhancements to the basic optimization framework that were created to make portfolio recommendations more palatable, easier to justify, or more sound from a fiduciary perspective. The specific features described here are: Advice Palatability Company Stock Advisability and the Diversity Budget Whole Percent Optimization Multiple Share Classes Money Market Funds S&P 500 Index Funds 3% Rule Pre-Mixed, Life-Cycle, a\\n\\n[3] Source: OptimizationEnhancementsSpec.doc\\nDocument: OptimizationEnhancementsSpec.doc - Engine Design Specification: Optimization Enhancements Version: 1.5 Notes: History. Table of Content...\\n\\nContent: ation Notes. 39 5.0 Unit Testing and Quality Assurance. 40 6.0 Future Directions. 40 7.0 References. 40 8.0 Open Items. 40 1.0 Summary. This document describes additional features used in constructing portfolio recommendations that are not described in the base specification document Optimization. That document describes the construction of portfolio expected return and covariance matrices for use in mean-variance optimization. The documents Load Aware Optimization and Taxable Advice describe adjustments to fund-level or account-level data that are fed into the optimization problem. This document details several enhancements to the basic optimization framework that were created to make portfolio recommendations more palatable, easier to justify, or more sound from a fiduciary perspective. The specific features described here are: Advice Palatability Company Stock Advisability and the Diversity Budget Whole Percent Optimization Multiple Share Classes Money Market Funds S&P 500 Index Fun\\n\\nQuestion: What factors should be considered in portfolio optimization?\\n\\nPlease provide a comprehensive answer based on the context above. Include source references where appropriate.'}], 'model': 'claude-3-haiku-20240307', 'system': \"You are a knowledgeable assistant that answers questions based on provided context. \\nFollow these guidelines:\\n\\n1. Use ONLY the provided context to answer the question\\n2. If the context doesn't contain enough information, say so clearly\\n3. Include specific references to sources when possible\\n4. Be concise but comprehensive\\n5. If uncertain, indicate your level of confidence\\n\\nContext will be provided as numbered chunks with source information.\", 'temperature': 0.1}}", "file": "_base_client.py", "line": 493, "function": "_build_request", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:47.212107", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Sending HTTP Request: POST https://api.anthropic.com/v1/messages", "file": "_base_client.py", "line": 1626, "function": "request", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:47.212359", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:47.212566", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:47.212615", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:47.212722", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:47.212772", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.672442", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 31 Jul 2025 22:45:50 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'50000'), (b'anthropic-ratelimit-input-tokens-remaining', b'50000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-07-31T22:45:48Z'), (b'anthropic-ratelimit-output-tokens-limit', b'10000'), (b'anthropic-ratelimit-output-tokens-remaining', b'10000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-07-31T22:45:53Z'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2025-07-31T22:45:48Z'), (b'anthropic-ratelimit-tokens-limit', b'60000'), (b'anthropic-ratelimit-tokens-remaining', b'60000'), (b'anthropic-ratelimit-tokens-reset', b'2025-07-31T22:45:48Z'), (b'request-id', b'req_011CRfudpnrpsS4LaT1N4GJX'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'c20be06b-ec2d-4d26-a60a-c6308d63ce1c'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9680a0ca8cde15a8-SJC'), (b'Content-Encoding', b'gzip')])", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.674560", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.676543", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.676975", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.677317", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.677845", "level": "DEBUG", "logger": "anthropic._base_client", "message": "HTTP Response: POST https://api.anthropic.com/v1/messages \"200 OK\" Headers({'date': 'Thu, 31 Jul 2025 22:45:50 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '50000', 'anthropic-ratelimit-input-tokens-remaining': '50000', 'anthropic-ratelimit-input-tokens-reset': '2025-07-31T22:45:48Z', 'anthropic-ratelimit-output-tokens-limit': '10000', 'anthropic-ratelimit-output-tokens-remaining': '10000', 'anthropic-ratelimit-output-tokens-reset': '2025-07-31T22:45:53Z', 'anthropic-ratelimit-requests-limit': '50', 'anthropic-ratelimit-requests-remaining': '49', 'anthropic-ratelimit-requests-reset': '2025-07-31T22:45:48Z', 'anthropic-ratelimit-tokens-limit': '60000', 'anthropic-ratelimit-tokens-remaining': '60000', 'anthropic-ratelimit-tokens-reset': '2025-07-31T22:45:48Z', 'request-id': 'req_011CRfudpnrpsS4LaT1N4GJX', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': 'c20be06b-ec2d-4d26-a60a-c6308d63ce1c', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '9680a0ca8cde15a8-SJC', 'content-encoding': 'gzip'})", "file": "_base_client.py", "line": 1664, "function": "request", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.678333", "level": "DEBUG", "logger": "anthropic._base_client", "message": "request_id: req_011CRfudpnrpsS4LaT1N4GJX", "file": "_base_client.py", "line": 1672, "function": "request", "taskName": "Task-32"}
{"timestamp": "2025-07-31T15:45:50.681123", "level": "WARNING", "logger": "rag_system.core.generator", "message": "Low confidence response: 0.64", "file": "generator.py", "line": 446, "function": "generate", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:50.682694", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Completed in 3.538s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-27", "request_id": "3f385e6b"}
INFO:     127.0.0.1:54130 - "POST /query HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T15:45:50.688552", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-35", "request_id": "0db657df"}
{"timestamp": "2025-07-31T15:45:50.689664", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline already initialized", "file": "pipeline.py", "line": 80, "function": "initialize", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T15:45:50.766788", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-913abe0d-358c-4ef3-8576-be0c953624fe', 'json_data': {'max_tokens': 1000, 'messages': [{'role': 'user', 'content': \"Context:\\n[1] Source: ProtectionSimulationSpec.docx\\nDocument: ProtectionSimulationSpec.docx - Engine Design Specification: Protection Simulation Version: v1.0 0.0 History. Table of Contents 0.0 ...\\n\\nContent: red to be in the set of risky assets and therefore eligible for inclusion in the tangency portfolio. We impose these conditions to be consistent with the Protection Optimization Specification (for more details see Section 3.2 of the Protection Optimization Specification). In cases where the plan has either multiple eligible money market funds or multiple eligible stable value funds, we choose the risk free asset in accordance with the logic described in Section 3.6 of the Optimization Enhancements Specification. If we are unable to set the maximization of Sharpe Ratio as our objective function, an alternative approach is to run tau based optimizations over a wide range of tau values, where tau denotes risk tolerance, and pick the one where the Sharpe Ratio is maximized: Step B2. We can derive from : Step B3. Record the outputs , and . 3.3 Wealth Evolution This section of the spec lays out the process for simulating the real portfolio wealth of a protected account.\\n\\n[2] Source: OptimizationSpec.doc\\nDocument: OptimizationSpec.doc - bjbj fen Financial Engines, Inc. Algorithm Design Specification: Optimization Version: Notes: Histor...\\n\\nContent: assets (assumed given). Cxx Covariance matrix for assets. Cyy Covariance matrix for outside assets. Cxy Covariance matrix between and outside asset specify these optimization input parameters. Assumptions and constraints. Mutual fund moments are based their exposures the GACs, selection return and selection variance. The risk slider corresponds total portfolio risk measured the annualized moments. The outside assets impact the optimization problem via the covariance between inside and outside assets ignoring tax adjustments. The proportion total assets outside the plan, determined current holdings. independent future contribution and asset allocation decisions. The volatility the market portfolio based annualized kernel moments. There are two possible user imposed constraints the optimization problem. First, users can lock fund imposing constraint that fund's allocation equals the locked amount. Second, users can specify preference for diversity sensitivity model Algorithm.\\n\\n[3] Source: OptimizationEnhancementsSpec.doc\\nDocument: OptimizationEnhancementsSpec.doc - Engine Design Specification: Optimization Enhancements Version: 1.3 Notes: History. Table of Content...\\n\\nContent: is constraint to avoid excessive number of holdings that may be caused by the concentration penalty. This constraint applies to the PA optimizations only where we have a stronger penalty on concentration for taxable accounts and IRAs. In particular we do not impose this constraint on 401(k) accounts. The left-hand-side of the constraint is the same sum that we use for the holdings penalty. It corresponds to the number of holdings in account a. maxHoldings is a predetermined integer. Currently we set maxHoldings = 13 which corresponds to 12 holdings per account excluding the cash sweep instrument. Technically this constraint uses the palatability budget since we do not add the same constraint in the MATCH RISK step; however, we do not expect this constraint to decrease the expected return of the portfolio for the values of maxHoldings we are planning to choose. ePenalty equation is a \u201csoft\u201d constraint that penalizes exceeding the diversity budget.\\n\\nQuestion: What is the exact mathematical formula for the Sharpe ratio optimization constraint?\\n\\nPlease provide a comprehensive answer based on the context above. Include source references where appropriate.\"}], 'model': 'claude-3-haiku-20240307', 'system': \"You are a knowledgeable assistant that answers questions based on provided context. \\nFollow these guidelines:\\n\\n1. Use ONLY the provided context to answer the question\\n2. If the context doesn't contain enough information, say so clearly\\n3. Include specific references to sources when possible\\n4. Be concise but comprehensive\\n5. If uncertain, indicate your level of confidence\\n\\nContext will be provided as numbered chunks with source information.\", 'temperature': 0.1}}", "file": "_base_client.py", "line": 493, "function": "_build_request", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:50.767255", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Sending HTTP Request: POST https://api.anthropic.com/v1/messages", "file": "_base_client.py", "line": 1626, "function": "request", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:50.767529", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:50.767746", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:50.767799", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:50.767947", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:50.768024", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.633910", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 31 Jul 2025 22:45:52 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'50000'), (b'anthropic-ratelimit-input-tokens-remaining', b'49000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-07-31T22:45:51Z'), (b'anthropic-ratelimit-output-tokens-limit', b'10000'), (b'anthropic-ratelimit-output-tokens-remaining', b'10000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-07-31T22:45:54Z'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2025-07-31T22:45:52Z'), (b'anthropic-ratelimit-tokens-limit', b'60000'), (b'anthropic-ratelimit-tokens-remaining', b'59000'), (b'anthropic-ratelimit-tokens-reset', b'2025-07-31T22:45:51Z'), (b'request-id', b'req_011CRfue5sxcEZBnZPkpdqUD'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'c20be06b-ec2d-4d26-a60a-c6308d63ce1c'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9680a0e0bd6815a8-SJC'), (b'Content-Encoding', b'gzip')])", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.634452", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.634727", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.634849", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.635003", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.635186", "level": "DEBUG", "logger": "anthropic._base_client", "message": "HTTP Response: POST https://api.anthropic.com/v1/messages \"200 OK\" Headers({'date': 'Thu, 31 Jul 2025 22:45:52 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '50000', 'anthropic-ratelimit-input-tokens-remaining': '49000', 'anthropic-ratelimit-input-tokens-reset': '2025-07-31T22:45:51Z', 'anthropic-ratelimit-output-tokens-limit': '10000', 'anthropic-ratelimit-output-tokens-remaining': '10000', 'anthropic-ratelimit-output-tokens-reset': '2025-07-31T22:45:54Z', 'anthropic-ratelimit-requests-limit': '50', 'anthropic-ratelimit-requests-remaining': '49', 'anthropic-ratelimit-requests-reset': '2025-07-31T22:45:52Z', 'anthropic-ratelimit-tokens-limit': '60000', 'anthropic-ratelimit-tokens-remaining': '59000', 'anthropic-ratelimit-tokens-reset': '2025-07-31T22:45:51Z', 'request-id': 'req_011CRfue5sxcEZBnZPkpdqUD', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': 'c20be06b-ec2d-4d26-a60a-c6308d63ce1c', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '9680a0e0bd6815a8-SJC', 'content-encoding': 'gzip'})", "file": "_base_client.py", "line": 1664, "function": "request", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.635402", "level": "DEBUG", "logger": "anthropic._base_client", "message": "request_id: req_011CRfue5sxcEZBnZPkpdqUD", "file": "_base_client.py", "line": 1672, "function": "request", "taskName": "Task-40"}
{"timestamp": "2025-07-31T15:45:52.636818", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Completed in 1.948s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-35", "request_id": "0db657df"}
INFO:     127.0.0.1:54132 - "POST /query HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T15:45:52.639816", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-43", "request_id": "68b97340"}
{"timestamp": "2025-07-31T15:45:52.640455", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline already initialized", "file": "pipeline.py", "line": 80, "function": "initialize", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T15:45:52.736085", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-d53e746f-080e-4d69-8445-b13bf3c1ed9f', 'json_data': {'max_tokens': 1000, 'messages': [{'role': 'user', 'content': 'Context:\\n[1] Source: AnnuitiesSpec.doc\\nDocument: AnnuitiesSpec.doc - bjbj Financial Engines, Inc. Algorithm Design Specification: Annuitization Version: Notes: History D...\\n\\nContent: imes New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w6PNG IHDR sRGB pHYs _xgFd FYlj j\u0302nc nne;O \u1112\u1175\u11b2OPF WehMVJ` 4oXO W\u0302h\u0767BH0\u03bb |Imtu N`qd>CZ Xf5g\u03a5qQVOo AOx\\n\\n[2] Source: AnnuitiesSpec.doc\\nDocument: AnnuitiesSpec.doc - bjbj Financial Engines, Inc. Algorithm Design Specification: Annuitization Version: Notes: History D...\\n\\nContent: imes New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w6PNG IHDR sRGB pHYs _xgFd FYlj j\u0302nc nne;O \u1112\u1175\u11b2OPF WehMVJ` 4oXO W\u0302h\u0767BH0\u03bb |Imtu N`qd>CZ Xf5g\u03a5qQVOo AOx\\n\\n[3] Source: AnnuitiesSpec.doc\\nDocument: AnnuitiesSpec.doc - bjbj Financial Engines, Inc. Algorithm Design Specification: Annuitization Version: Notes: History D...\\n\\nContent: imes New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w:ascii=\"Cambria Math\" w:fareast=\"Times New Roman\" w:h-ansi=\"Cambria wx:val=\"Cambria w6PNG IHDR sRGB pHYs _xgFd FYlj j\u0302nc nne;O \u1112\u1175\u11b2OPF WehMVJ` 4oXO W\u0302h\u0767BH0\u03bb |Imtu N`qd>CZ Xf5g\u03a5qQVOo AOx\\n\\nQuestion: How do I cook pasta?\\n\\nPlease provide a comprehensive answer based on the context above. Include source references where appropriate.'}], 'model': 'claude-3-haiku-20240307', 'system': \"You are a knowledgeable assistant that answers questions based on provided context. \\nFollow these guidelines:\\n\\n1. Use ONLY the provided context to answer the question\\n2. If the context doesn't contain enough information, say so clearly\\n3. Include specific references to sources when possible\\n4. Be concise but comprehensive\\n5. If uncertain, indicate your level of confidence\\n\\nContext will be provided as numbered chunks with source information.\", 'temperature': 0.1}}", "file": "_base_client.py", "line": 493, "function": "_build_request", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:52.736497", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Sending HTTP Request: POST https://api.anthropic.com/v1/messages", "file": "_base_client.py", "line": 1626, "function": "request", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:52.736734", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:52.736927", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:52.736974", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:52.737076", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:52.737118", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.740432", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 31 Jul 2025 22:45:53 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'anthropic-ratelimit-input-tokens-limit', b'50000'), (b'anthropic-ratelimit-input-tokens-remaining', b'49000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-07-31T22:45:54Z'), (b'anthropic-ratelimit-output-tokens-limit', b'10000'), (b'anthropic-ratelimit-output-tokens-remaining', b'10000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-07-31T22:45:55Z'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'49'), (b'anthropic-ratelimit-requests-reset', b'2025-07-31T22:45:54Z'), (b'anthropic-ratelimit-tokens-limit', b'60000'), (b'anthropic-ratelimit-tokens-remaining', b'59000'), (b'anthropic-ratelimit-tokens-reset', b'2025-07-31T22:45:54Z'), (b'request-id', b'req_011CRfueELT8Jz67ndyvdQhA'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'c20be06b-ec2d-4d26-a60a-c6308d63ce1c'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9680a0ed0fa015a8-SJC')])", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.742854", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.744640", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.745027", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.745369", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.745841", "level": "DEBUG", "logger": "anthropic._base_client", "message": "HTTP Response: POST https://api.anthropic.com/v1/messages \"200 OK\" Headers({'date': 'Thu, 31 Jul 2025 22:45:53 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'anthropic-ratelimit-input-tokens-limit': '50000', 'anthropic-ratelimit-input-tokens-remaining': '49000', 'anthropic-ratelimit-input-tokens-reset': '2025-07-31T22:45:54Z', 'anthropic-ratelimit-output-tokens-limit': '10000', 'anthropic-ratelimit-output-tokens-remaining': '10000', 'anthropic-ratelimit-output-tokens-reset': '2025-07-31T22:45:55Z', 'anthropic-ratelimit-requests-limit': '50', 'anthropic-ratelimit-requests-remaining': '49', 'anthropic-ratelimit-requests-reset': '2025-07-31T22:45:54Z', 'anthropic-ratelimit-tokens-limit': '60000', 'anthropic-ratelimit-tokens-remaining': '59000', 'anthropic-ratelimit-tokens-reset': '2025-07-31T22:45:54Z', 'request-id': 'req_011CRfueELT8Jz67ndyvdQhA', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': 'c20be06b-ec2d-4d26-a60a-c6308d63ce1c', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '9680a0ed0fa015a8-SJC'})", "file": "_base_client.py", "line": 1664, "function": "request", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.746345", "level": "DEBUG", "logger": "anthropic._base_client", "message": "request_id: req_011CRfueELT8Jz67ndyvdQhA", "file": "_base_client.py", "line": 1672, "function": "request", "taskName": "Task-48"}
{"timestamp": "2025-07-31T15:45:53.749138", "level": "WARNING", "logger": "rag_system.core.generator", "message": "Low confidence response: 0.52", "file": "generator.py", "line": 446, "function": "generate", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T15:45:53.750394", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Completed in 1.110s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-43", "request_id": "68b97340"}
INFO:     127.0.0.1:54134 - "POST /query HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T15:45:53.764536", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-51", "request_id": "44c9101b"}
{"timestamp": "2025-07-31T15:45:53.765464", "level": "INFO", "logger": "rag_system.core.pipeline", "message": "Pipeline already initialized", "file": "pipeline.py", "line": 80, "function": "initialize", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T15:45:53.823612", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Request options: {'method': 'post', 'url': '/v1/messages', 'files': None, 'idempotency_key': 'stainless-python-retry-34077d7f-8b09-42cc-892d-7bcec9418d4a', 'json_data': {'max_tokens': 1000, 'messages': [{'role': 'user', 'content': 'Context:\\n[1] Source: FE_Invest_Methodology_WhitePaper_101510c_Final.pdf\\nDocument: FE_Invest_Methodology_WhitePaper_101510c_Final.pdf - Investment Methodology A Due Diligence Guide Financial Engines Investment Methodologyii Table of Con...\\n\\nContent: ines regularly updates the target allocation for each member of its Professional Management program. In general, Financial Engines reviews member portfolios at least once every month for potential adjustments. In addition to monthly reviews, off-cycle reviews may be performed at the individual, company, or aggregate level. Off-cycle reviews can be triggered by changes in a member\u2019s personalization options, changes in the investment options within a plan, and unusual market events or volatility. Prudent management implies that rebalancing should only occur in response to material changes in key economic and financial factors. Financial Engines will typically not execute transactions for portfolios within 5% turnover of their target allocation, unless there has not been a completed transaction within the last six months.\\n\\n[2] Source: Invest_Methodology_WhitePaper_120710.pdf\\nDocument: Invest_Methodology_WhitePaper_120710.pdf - Investment Methodology A Due Diligence Guide Financial Engines Investment Methodologyii Table of Con...\\n\\nContent: ines regularly updates the target allocation for each member of its Professional Management program. In general, Financial Engines reviews member portfolios at least once every month for potential adjustments. In addition to monthly reviews, off-cycle reviews may be performed at the individual, company, or aggregate level. Off-cycle reviews can be triggered by changes in a member\u2019s personalization options, changes in the investment options within a plan, and unusual market events or volatility. Prudent management implies that rebalancing should only occur in response to material changes in key economic and financial factors. Financial Engines will typically not execute transactions for portfolios within 5% turnover of their target allocation, unless there has not been a completed transaction within the last six months.\\n\\n[3] Source: PortfolioManagementWhitePaper_07_31_2009.pdf\\nDocument: PortfolioManagementWhitePaper_07_31_2009.pdf - WHITE PAPER Financial Engines Portfolio Management in the Professional Management Program July 2009 ...\\n\\nContent: n that properly diversifies the manageable assets against the volatility of the non-manag ed assets. For example, if the member reports fairly aggressive holdings in a taxable account, the managed retirement account portfolio will be more conservative. As another example, a large holding in growth stocks in a non-managed account may be counterbalanced by an overweighting of value stocks in the managed account. This \u201ctotal portfolio\u201d approach offers a distinct advantage over target date funds, which are unable to account for other retirement investments. The Transition Period During the transition period, Financial Engines typically makes gradual adjustments to the member\u2019s holdings toward a portfolio target.8 These changes are executed in stages to increase the member\u2019s comfort level with the transactions to reach the portfolio targets, to reduce the market impact of the sale of company stock, and to decrease the likelihood of viol ating stable value aggregate transaction covenants.\\n\\nQuestion: What is the purpose of rebalancing in portfolio management?\\n\\nPlease provide a comprehensive answer based on the context above. Include source references where appropriate.'}], 'model': 'claude-3-haiku-20240307', 'system': \"You are a knowledgeable assistant that answers questions based on provided context. \\nFollow these guidelines:\\n\\n1. Use ONLY the provided context to answer the question\\n2. If the context doesn't contain enough information, say so clearly\\n3. Include specific references to sources when possible\\n4. Be concise but comprehensive\\n5. If uncertain, indicate your level of confidence\\n\\nContext will be provided as numbered chunks with source information.\", 'temperature': 0.1}}", "file": "_base_client.py", "line": 493, "function": "_build_request", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:53.824042", "level": "DEBUG", "logger": "anthropic._base_client", "message": "Sending HTTP Request: POST https://api.anthropic.com/v1/messages", "file": "_base_client.py", "line": 1626, "function": "request", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:53.824284", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:53.824492", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_headers.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:53.824544", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:53.824651", "level": "DEBUG", "logger": "httpcore.http11", "message": "send_request_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:53.824695", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.671543", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Thu, 31 Jul 2025 22:45:56 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'anthropic-ratelimit-input-tokens-limit', b'50000'), (b'anthropic-ratelimit-input-tokens-remaining', b'49000'), (b'anthropic-ratelimit-input-tokens-reset', b'2025-07-31T22:45:55Z'), (b'anthropic-ratelimit-output-tokens-limit', b'10000'), (b'anthropic-ratelimit-output-tokens-remaining', b'10000'), (b'anthropic-ratelimit-output-tokens-reset', b'2025-07-31T22:45:58Z'), (b'anthropic-ratelimit-requests-limit', b'50'), (b'anthropic-ratelimit-requests-remaining', b'48'), (b'anthropic-ratelimit-requests-reset', b'2025-07-31T22:45:55Z'), (b'anthropic-ratelimit-tokens-limit', b'60000'), (b'anthropic-ratelimit-tokens-remaining', b'59000'), (b'anthropic-ratelimit-tokens-reset', b'2025-07-31T22:45:55Z'), (b'request-id', b'req_011CRfueJxWpiY3pQdbrEEDb'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'c20be06b-ec2d-4d26-a60a-c6308d63ce1c'), (b'via', b'1.1 google'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9680a0f3d9b015a8-SJC'), (b'Content-Encoding', b'gzip')])", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.672894", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.started request=<Request [b'POST']>", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.673440", "level": "DEBUG", "logger": "httpcore.http11", "message": "receive_response_body.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.673640", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.started", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.673811", "level": "DEBUG", "logger": "httpcore.http11", "message": "response_closed.complete", "file": "_trace.py", "line": 87, "function": "atrace", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.674077", "level": "DEBUG", "logger": "anthropic._base_client", "message": "HTTP Response: POST https://api.anthropic.com/v1/messages \"200 OK\" Headers({'date': 'Thu, 31 Jul 2025 22:45:56 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'anthropic-ratelimit-input-tokens-limit': '50000', 'anthropic-ratelimit-input-tokens-remaining': '49000', 'anthropic-ratelimit-input-tokens-reset': '2025-07-31T22:45:55Z', 'anthropic-ratelimit-output-tokens-limit': '10000', 'anthropic-ratelimit-output-tokens-remaining': '10000', 'anthropic-ratelimit-output-tokens-reset': '2025-07-31T22:45:58Z', 'anthropic-ratelimit-requests-limit': '50', 'anthropic-ratelimit-requests-remaining': '48', 'anthropic-ratelimit-requests-reset': '2025-07-31T22:45:55Z', 'anthropic-ratelimit-tokens-limit': '60000', 'anthropic-ratelimit-tokens-remaining': '59000', 'anthropic-ratelimit-tokens-reset': '2025-07-31T22:45:55Z', 'request-id': 'req_011CRfueJxWpiY3pQdbrEEDb', 'strict-transport-security': 'max-age=31536000; includeSubDomains; preload', 'anthropic-organization-id': 'c20be06b-ec2d-4d26-a60a-c6308d63ce1c', 'via': '1.1 google', 'cf-cache-status': 'DYNAMIC', 'x-robots-tag': 'none', 'server': 'cloudflare', 'cf-ray': '9680a0f3d9b015a8-SJC', 'content-encoding': 'gzip'})", "file": "_base_client.py", "line": 1664, "function": "request", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.674338", "level": "DEBUG", "logger": "anthropic._base_client", "message": "request_id: req_011CRfueJxWpiY3pQdbrEEDb", "file": "_base_client.py", "line": 1672, "function": "request", "taskName": "Task-56"}
{"timestamp": "2025-07-31T15:45:56.676123", "level": "INFO", "logger": "rag_system.api", "message": "POST /query - Completed in 2.912s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-51", "request_id": "44c9101b"}
INFO:     127.0.0.1:54136 - "POST /query HTTP/1.1" 200 OK
{"timestamp": "2025-07-31T20:49:44.831225", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-59", "request_id": "b33b5cc9"}
{"timestamp": "2025-07-31T20:49:45.870939", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:49:48.086534", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:49:48.093521", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
/opt/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py:1762: FutureWarning: `encoder_attention_mask` is deprecated and will be removed in version 4.55.0 for `BertSdpaSelfAttention.forward`.
  return forward_call(*args, **kwargs)
{"timestamp": "2025-07-31T20:49:50.282374", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 5.447s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:49:50.288736", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 5.458s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-59", "request_id": "b33b5cc9"}
{"timestamp": "2025-07-31T20:50:14.182762", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-62", "request_id": "1955f6da"}
{"timestamp": "2025-07-31T20:50:15.207571", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:17.222842", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:17.228929", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:19.357781", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 5.174s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:19.367726", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 5.185s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-62", "request_id": "1955f6da"}
{"timestamp": "2025-07-31T20:50:51.201499", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-65", "request_id": "cdf0f4ab"}
{"timestamp": "2025-07-31T20:50:52.214969", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:53.990857", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:53.993650", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:56.611061", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 5.408s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:56.672385", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 5.471s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-65", "request_id": "cdf0f4ab"}
{"timestamp": "2025-07-31T20:50:56.672574", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-68", "request_id": "0befbe50"}
{"timestamp": "2025-07-31T20:50:57.686079", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:59.474877", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:50:59.477070", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:01.741758", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 5.069s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:01.747282", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 5.075s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-68", "request_id": "0befbe50"}
{"timestamp": "2025-07-31T20:51:01.747467", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-71", "request_id": "b45dd41f"}
{"timestamp": "2025-07-31T20:51:02.758977", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:04.570373", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:04.573029", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:06.508546", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.761s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:06.570041", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-74", "request_id": "4aa63cfe"}
{"timestamp": "2025-07-31T20:51:07.586231", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:09.371132", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:09.373385", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:11.357864", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.788s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:11.362776", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 9.615s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-71", "request_id": "b45dd41f"}
{"timestamp": "2025-07-31T20:51:11.362988", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-77", "request_id": "2a379fa6"}
{"timestamp": "2025-07-31T20:51:11.363151", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 4.793s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-74", "request_id": "4aa63cfe"}
{"timestamp": "2025-07-31T20:51:12.376954", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:14.105982", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:14.107525", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:16.138262", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.775s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:16.204997", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-80", "request_id": "3d3a3d46"}
{"timestamp": "2025-07-31T20:51:17.216309", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:18.990436", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:18.991070", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:20.812946", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.607s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:20.818169", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-83", "request_id": "720fdede"}
{"timestamp": "2025-07-31T20:51:20.818438", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 9.455s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-77", "request_id": "2a379fa6"}
{"timestamp": "2025-07-31T20:51:21.828350", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:23.644946", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:23.646089", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:25.933363", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 5.115s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:25.937929", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-86", "request_id": "bb1deb11"}
{"timestamp": "2025-07-31T20:51:25.938185", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 9.733s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-80", "request_id": "3d3a3d46"}
{"timestamp": "2025-07-31T20:51:26.945100", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:28.646661", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:28.647781", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:30.498142", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.560s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:30.502807", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-89", "request_id": "b8ec317b"}
{"timestamp": "2025-07-31T20:51:30.503078", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 9.685s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-83", "request_id": "720fdede"}
{"timestamp": "2025-07-31T20:51:31.517956", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:33.381758", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:33.382906", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:35.220130", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.717s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:35.282538", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Request started", "file": "server.py", "line": 192, "function": "monitoring_middleware", "taskName": "Task-92", "request_id": "16d823fa"}
{"timestamp": "2025-07-31T20:51:35.282775", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 9.345s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-86", "request_id": "bb1deb11"}
{"timestamp": "2025-07-31T20:51:36.310873", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loading embedding model: sentence-transformers/all-MiniLM-L6-v2", "file": "vector_store.py", "line": 69, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:38.171568", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Loaded embedding model with dimension: 384", "file": "vector_store.py", "line": 74, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:38.172575", "level": "INFO", "logger": "rag_system.storage.vector_store", "message": "Retrieved existing collection: rag_documents", "file": "vector_store.py", "line": 82, "function": "__init__", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:39.971379", "level": "INFO", "logger": "rag_system.monitoring", "message": "Health checks completed in 4.688s - Status: healthy", "file": "health.py", "line": 103, "function": "run_health_checks", "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}
{"timestamp": "2025-07-31T20:51:39.976499", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 9.474s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-89", "request_id": "b8ec317b"}
{"timestamp": "2025-07-31T20:51:39.976703", "level": "INFO", "logger": "rag_system.api", "message": "GET /health - Completed in 4.694s with status 200", "file": "server.py", "line": 210, "function": "monitoring_middleware", "taskName": "Task-92", "request_id": "16d823fa"}
INFO:     Shutting down
INFO:     Waiting for application shutdown.
{"timestamp": "2025-07-31T20:54:35.179032", "level": "INFO", "logger": "rag_system.api", "message": "Shutting down RAG API server...", "file": "server.py", "line": 149, "function": "lifespan", "taskName": "Task-2"}
INFO:     Application shutdown complete.
INFO:     Finished server process [38127]
/opt/miniconda3/lib/python3.12/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
